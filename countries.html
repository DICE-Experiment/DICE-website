<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Country Teams ‚Äî DICE</title>
  <meta name="description" content="DICE project country teams and research details." />
  <link rel="canonical" href="https://dice-experiment.github.io/DICE-website/countries.html" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="color-scheme" content="dark light" />
  <meta name="theme-color" content="#0b1225" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0b1225; --surface:#0f172a; --card:#0e162d; --muted:#94a3b8; --text:#e5e7eb;
      --line:#1f2937; --brand:#D49D39; --accent:#193865; --warn:#fbbf24; --chip:#111827;
      --shadow: 0 12px 30px rgba(0,0,0,.35);
      --brand-rgb:212,157,57; --accent-rgb:25,56,101;
    }
    [data-theme="light"]{
      --bg:#f8fafc; --surface:#ffffff; --card:#f1f5f9; --muted:#64748b; --text:#0f172a;
      --line:#e2e8f0; --brand:#D49D39; --accent:#193865; --warn:#d97706; --chip:#e2e8f0;
      --shadow: 0 4px 12px rgba(0,0,0,.08);
      --brand-rgb:212,157,57; --accent-rgb:25,56,101;
    }
    *{box-sizing:border-box}
    html,body{margin:0; padding:0; background:var(--bg); color:var(--text); font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
    a{color:var(--brand); text-decoration:none}
    a:hover{text-decoration:underline}
    a:focus-visible, button:focus-visible{outline:2px solid var(--brand); outline-offset:2px}
    .container{max-width:1200px; margin:0 auto; padding:0 20px}
    .nav{position:sticky; top:0; z-index:20; background:rgba(10,15,30,.75); backdrop-filter: blur(8px); border-bottom:1px solid var(--line)}
    [data-theme="light"] .nav{background:rgba(248,250,252,.95); color:var(--text)}
    .nav-inner{display:flex; align-items:center; justify-content:space-between; padding:12px 0; gap:12px}
    .brand{display:flex; align-items:center; gap:10px; font-weight:800; white-space:nowrap; flex-shrink:0}
    .brand .small, .brand span[style*="font-size:12px"]{font-size:10px !important; max-width:180px}
    .logo{width:40px; height:40px; display:flex; align-items:center; justify-content:center;}
    .logo img{width:100%; height:100%; object-fit:contain;}
    .tabs{display:flex; gap:6px; flex-wrap:nowrap; flex-shrink:1}
    .tabs a, .tabs button{padding:8px 10px; background:var(--chip); border:1px solid var(--line); border-radius:10px; font-size:13px; white-space:nowrap; min-height:36px; display:inline-flex; align-items:center; justify-content:center}
    .tabs a:hover{border-color:var(--brand); transform:translateY(-1px)}
    h1{font-size:42px; margin:10px 0 8px}
    h2{font-size:28px; margin:0 0 16px}
    [data-theme="light"] h1, [data-theme="light"] h2{color:var(--accent)}
    .sub{color:var(--muted); font-size:18px; max-width:900px}
    .card{background:var(--card); border:1px solid var(--line); border-radius:16px; padding:22px; box-shadow:var(--shadow)}
    .grid{display:grid; gap:16px}
    .cols-3{grid-template-columns:repeat(3,1fr)}
    @media (max-width:1300px){
      .tabs a, .tabs button{padding:8px 8px; font-size:12px}
      .brand span[style*="font-size:12px"]{font-size:9px !important; max-width:160px}
    }
    @media (max-width:980px){
      .cols-3{grid-template-columns:repeat(2,1fr)}
      .brand span[style*="font-size:12px"]{font-size:9px !important}
      .tabs{flex-wrap:wrap}
    }
    @media (max-width:640px){ .cols-3{grid-template-columns:1fr} h1{font-size:34px} }
    .country-card{scroll-margin-top:80px; transition:all 0.3s ease; position:relative;}
    .country-info{display:flex; flex-direction:column; gap:12px; margin-top:12px}
    .info-row{display:flex; gap:8px; font-size:14px; line-height:1.5}
    .info-row strong{min-width:110px; color:var(--muted)}
    .info-row span{color:var(--text)}
    section{padding:50px 0}
    .lang-btn{display:flex; gap:2px; padding:4px 6px; background:var(--chip); border:1px solid var(--line); border-radius:10px; cursor:pointer; font-size:12px; font-weight:600; transition:border-color .2s; min-height:36px; align-items:center}
    .lang-btn:hover{border-color:var(--brand)}
    .lang-option{padding:4px 6px; border-radius:6px; color:var(--muted); transition:all .2s}
    .lang-option.active{background:var(--brand); color:#fff; font-weight:600}
    .back-link{display:inline-flex; align-items:center; gap:8px; margin-bottom:20px; padding:8px 12px; background:var(--chip); border:1px solid var(--line); border-radius:10px; font-size:14px; transition:all .2s}
    .back-link:hover{border-color:var(--brand); transform:translateY(-1px); text-decoration:none}
  </style>
</head>
<body>


<!-- NAV -->
<div class="nav" role="navigation" aria-label="principal">
  <div class="container nav-inner">
    <a href="index.html" class="brand" style="text-decoration:none; color:inherit;">
      <div class="logo" aria-hidden="true"><img src="logo.png" alt="DICE Logo"></div>
      <div>DICE ‚Äî <span style="font-size:12px; color:var(--muted)" data-i18n="nav.subtitle">Experimento multicultural en aula</span></div>
    </a>
    <nav class="tabs">
      <a href="index.html">‚Üê <span data-i18n="nav.back">Volver</span></a>
      <button id="theme-toggle" class="lang-btn" aria-label="Change theme">
        <span class="lang-option" data-theme-opt="dark">üåô</span>
        <span class="lang-option" data-theme-opt="light">‚òÄÔ∏è</span>
        <span class="lang-option active" data-theme-opt="auto">Auto</span>
      </button>
      <button id="lang-toggle" class="lang-btn" aria-label="Change language">
        <span class="lang-option" data-lang="en">EN</span>
        <span class="lang-option active" data-lang="es">ES</span>
      </button>
    </nav>
  </div>
</div>

<main id="main">
  <section id="paises-detalles" style="background:var(--surface)">
    <div class="container">
      <a href="index.html" class="back-link">
        <span>‚Üê</span>
        <span data-i18n="nav.backToMain">Volver a inicio</span>
      </a>
      <h2 data-i18n="countryDetails.title">Equipos por pa√≠s</h2>
      <p class="sub" data-i18n="countryDetails.subtitle">Informaci√≥n detallada de cada equipo de investigaci√≥n participante.</p>

      <div id="countries-grid" class="grid cols-3" style="margin-top:24px">
        <!-- Countries will be loaded dynamically from country-data.json -->
        <div style="grid-column: 1/-1; text-align: center; padding: 60px; color: #64748b;">
          <div style="font-size: 16px; margin-bottom: 8px;">Loading countries...</div>
          <div style="font-size: 13px; color: #475569;">Please wait while we load the country data</div>
        </div>
      </div>
  </section>
</main>

<footer style="padding:40px 0; color:#94a3b8; border-top:1px solid #1f2937; margin-top:40px;">
  <div class="container">
    <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:20px;">
      <div>
        <span style="font-size:12px; color:#64748b;">DICE Project - Country Teams</span>
      </div>
      <div style="text-align:right;">
        <span style="font-size:12px; color:#D49D39; font-weight:600;">Version: <span id="data-version">2025.11.11.v22</span></span>
      </div>
    </div>
  </div>
</footer>

<script>
  // Translations
  const translations = {
    en: {
      nav: {
        subtitle: 'Multicultural classroom experiment',
        back: 'Back',
        backToMain: 'Back to home'
      },
      countryDetails: {
        title: 'Country Teams',
        subtitle: 'Detailed information about each participating research team.',
        team: 'Team:',
        institution: 'Institution:',
        city: 'City:',
        sample: 'Sample:',
        observations: 'Observations:'
      }
    },
    es: {
      nav: {
        subtitle: 'Experimento multicultural en aula',
        back: 'Volver',
        backToMain: 'Volver a inicio'
      },
      countryDetails: {
        title: 'Equipos por pa√≠s',
        subtitle: 'Informaci√≥n detallada de cada equipo de investigaci√≥n participante.',
        team: 'Equipo:',
        institution: 'Instituci√≥n:',
        city: 'Ciudad:',
        sample: 'Muestra:',
        observations: 'Observaciones:'
      }
    }
  };

  // Theme switcher
  let currentTheme = localStorage.getItem('theme') || 'auto';

  function applyTheme(theme) {
    currentTheme = theme;
    localStorage.setItem('theme', theme);

    if (theme === 'auto') {
      // Follow system preference
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      document.documentElement.setAttribute('data-theme', prefersDark ? 'dark' : 'light');
    } else {
      document.documentElement.setAttribute('data-theme', theme);
    }

    // Update active theme button
    document.querySelectorAll('[data-theme-opt]').forEach(opt => {
      opt.classList.toggle('active', opt.getAttribute('data-theme-opt') === theme);
    });
  }

  // Listen for system theme changes when in auto mode
  window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
    if (currentTheme === 'auto') {
      document.documentElement.setAttribute('data-theme', e.matches ? 'dark' : 'light');
    }
  });

  // Language switcher
  let currentLang = localStorage.getItem('lang') || 'es';

  function setLanguage(lang) {
    // Validate language exists in translations
    if (!translations[lang]) {
      console.warn(`Language '${lang}' not found, defaulting to 'es'`);
      lang = 'es';
    }

    currentLang = lang;
    localStorage.setItem('lang', lang);
    document.documentElement.setAttribute('lang', lang);

    // Update all elements with data-i18n
    document.querySelectorAll('[data-i18n]').forEach(el => {
      const key = el.getAttribute('data-i18n');
      const keys = key.split('.');
      let value = translations[lang];
      keys.forEach(k => {
        if (value && typeof value === 'object') {
          value = value[k];
        }
      });
      if (value) el.innerHTML = value;
    });

    // Update active language button
    document.querySelectorAll('[data-lang]').forEach(opt => {
      opt.classList.toggle('active', opt.getAttribute('data-lang') === lang);
    });
  }

  // Initialize language and theme on page load
  document.addEventListener('DOMContentLoaded', () => {
    // Apply theme first (before rendering)
    applyTheme(currentTheme);

    // Theme toggle click handler
    document.querySelectorAll('[data-theme-opt]').forEach(opt => {
      opt.addEventListener('click', () => {
        applyTheme(opt.getAttribute('data-theme-opt'));
      });
    });

    setLanguage(currentLang);

    // Language toggle click handler
    document.querySelectorAll('[data-lang]').forEach(opt => {
      opt.addEventListener('click', () => {
        setLanguage(opt.getAttribute('data-lang'));
      });
    });

    // Scroll to element if hash exists
    const hash = window.location.hash;
    if (hash) {
      const element = document.querySelector(hash);
      if (element) {
        setTimeout(() => {
          element.scrollIntoView({ behavior: 'smooth' });
        }, 100);
      }
    }

    // Load country data from JSON
    fetch('country-data.json')
      .then(response => response.json())
      .then(data => {
        const countryData = data.countryData;
        const grid = document.getElementById('countries-grid');

        if (!grid) return;

        // Clear loading message
        grid.innerHTML = '';

        // Sort countries alphabetically by name
        const sortedCountries = Object.entries(countryData).sort((a, b) =>
          a[1].name.localeCompare(b[1].name)
        );

        // Generate country cards
        sortedCountries.forEach(([iso3, country]) => {
          const card = document.createElement('div');
          card.id = country.anchor;
          card.className = 'country-card card';

          // Create card content
          card.innerHTML = `
            <h3>${country.flag} ${country.name}</h3>
            <div class="country-info">
              <div class="info-row">
                <strong data-i18n="countryDetails.team">Team:</strong>
                <span>${country.team}</span>
              </div>
              <div class="info-row">
                <strong data-i18n="countryDetails.institution">Institution:</strong>
                <span>${country.institution}</span>
              </div>
              <div class="info-row">
                <strong data-i18n="countryDetails.sample">Sample:</strong>
                <span>${country.sample}</span>
              </div>
            </div>
          `;

          grid.appendChild(card);
        });

        // Re-apply translations to the newly created elements
        setLanguage(currentLang);

        // Scroll to hash if exists (after cards are loaded) AND apply highlight animation
        if (hash) {
          const element = document.querySelector(hash);
          if (element) {
            setTimeout(() => {
              element.scrollIntoView({ behavior: 'smooth' });

              // Apply highlight effect
              element.style.background = 'linear-gradient(135deg, rgba(96,165,250,0.3) 0%, rgba(96,165,250,0.15) 100%)';
              element.style.border = '3px solid #60a5fa';
              element.style.boxShadow = '0 0 0 6px rgba(96,165,250,0.5), 0 16px 40px rgba(96,165,250,0.4)';
              element.style.transform = 'scale(1.05)';
              element.style.transition = 'all 0.3s ease';

              // Remove highlight after 2 seconds
              setTimeout(() => {
                element.style.background = '';
                element.style.border = '';
                element.style.boxShadow = '';
                element.style.transform = '';
              }, 2000);
            }, 200);
          }
        }

        console.log(`Loaded ${sortedCountries.length} countries successfully`);
      })
      .catch(error => {
        console.error('Error loading country data:', error);
        const grid = document.getElementById('countries-grid');
        if (grid) {
          grid.innerHTML = `
            <div style="grid-column: 1/-1; text-align: center; padding: 60px; color: #dc2626;">
              <div style="font-size: 16px; margin-bottom: 8px;">Error loading country data</div>
              <div style="font-size: 13px; color: #ef4444;">Please ensure country-data.json exists and you are running a local server.</div>
            </div>
          `;
        }
      });
  });

  // Handle hash changes (if user navigates between countries while on page)
  window.addEventListener('hashchange', function() {
    const hash = window.location.hash;
    if (hash) {
      const element = document.querySelector(hash);
      if (element) {
        // Remove highlight from all cards first
        document.querySelectorAll('.country-card').forEach(card => {
          card.style.background = '';
          card.style.border = '';
          card.style.boxShadow = '';
          card.style.transform = '';
        });

        // Scroll to element
        element.scrollIntoView({ behavior: 'smooth' });

        // Apply highlight
        element.style.background = 'linear-gradient(135deg, rgba(96,165,250,0.3) 0%, rgba(96,165,250,0.15) 100%)';
        element.style.border = '3px solid #60a5fa';
        element.style.boxShadow = '0 0 0 6px rgba(96,165,250,0.5), 0 16px 40px rgba(96,165,250,0.4)';
        element.style.transform = 'scale(1.05)';
        element.style.transition = 'all 0.3s ease';

        // Remove highlight after 2 seconds
        setTimeout(function() {
          element.style.background = '';
          element.style.border = '';
          element.style.boxShadow = '';
          element.style.transform = '';
        }, 2000);
      }
    }
  });

  // HIGHLIGHT EFFECT - Run after everything loads
  window.addEventListener('load', function() {
    var hash = window.location.hash;

    if (hash) {
      var element = document.querySelector(hash);

      if (element) {
        // Apply highlight effect
        element.style.background = 'linear-gradient(135deg, rgba(96,165,250,0.3) 0%, rgba(96,165,250,0.15) 100%)';
        element.style.border = '3px solid #60a5fa';
        element.style.boxShadow = '0 0 0 6px rgba(96,165,250,0.5), 0 16px 40px rgba(96,165,250,0.4)';
        element.style.transform = 'scale(1.05)';
        element.style.transition = 'all 0.3s ease';

        // Remove highlight after 2 seconds
        setTimeout(function() {
          element.style.background = '';
          element.style.border = '';
          element.style.boxShadow = '';
          element.style.transform = '';
        }, 2000);
      }
    }
  });
</script>

</body>
</html>
